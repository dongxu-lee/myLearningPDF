# 分布式集群时钟同步问题及解决方案学习笔记

## 1. 同步配置

原理：保证获取时间的来源唯一

### 1.1 各个节点都可以访问互联网
各个节点都去访问<B>国家授时中心</B>/<B>时间服务器</B>同步时间

### 1.2 只有部分服务器访问互联网
选择某一台能联网的服务器作为时间服务器，其他服务器都去和这一台服务器同步时间，这台服务器和互联网同步时间

### 1.3 选择集群中的一台服务器作为时间服务器
其他服务器都去访问这一台服务器来同步时间

## 操作方式
选取集群中的一个服务器A（172.17.0.17）作为时间服务器

 - 首先设置好A的时间
 - 把A配置为时间服务器（修改/etc/ntp.conf文件）
 > 1. 如果有restrict default ignore，注释掉它
 > 2. 添加如下几行内容
		restrict 172.17.0.0 mask 255.255.255.0 modify notrap # 放开局域网同步功能，172.17.0.0是局域网网段
		server 127.127.1.0 # local clock
		fudge 127.127.1.0 stratum 10
> 3. 重启生效并配置ntpd服务开机自启动
		service ntpd restart
		chkconfig ntpd on
 - 集群中其他节点就可以从A服务器同步时间了
	~~~
	ntpdate 172.17.0.17
	~~~
